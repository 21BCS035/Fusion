{% load static %}
{% block medical_relief %}

    {% comment %}
    The left-rail segment ends here!
    {% endcomment %}

    {% comment %}
    The central-rail segment starts here!
    {% endcomment %}
    <div class="ui pointing secondary menu">
        <a class="active item" data-tab="relief">
           
            Apply For Medical Relief
        </a>

        <a class="item" data-tab="inbox">
            Approval Status
        </a>
        
    </div>
    <div class="ui active tab" data-tab="relief">
        <div class="ui vertical segment">
            <form class="ui form" method="POST" style="padding: 8px; padding-left: 24px; padding-right: 24px;">{% csrf_token %}
                <div class="field">
                    <label for="file">File</label>
                    <div class="ui fluid input">
                        <input type="file" name="file" id="file">
                    </div>
                </div>
                
                <br>
        
                <div class="field">
                    <label for="description">Description</label>
                    <div class="ui fluid input">
                        <textarea id="description" class="ui textarea" name="description" type="text" required="true"></textarea>
                    </div>
                </div>
        
                <br>
        
                <div class="field">
                    <label for="designation">Send to</label>
                    <div class="ui fluid input">
                        <select id="designation" name="designation">
                            {% for queryset in holdsDesignations %}
                                {% for hd in queryset %}
                                    <option value="{{ hd.user.username }}">{{ hd.designation }}({{ hd.user.username }})</option>
                                {% endfor %}
                            {% endfor %}
                        </select>
                    </div>
                </div>
        
                        <div class="field">
                            <label><br></label>
        
                            <div>
                              <input type="button" id="Submit" name="Submit" value="Send" class="ui small right floated primary button" />
                            </div>
        
                        </div>
                    </form>
                                       
                        <script type="text/javascript">
                            $('#Submit').click(function(e) {
                                // Prevent the default form submission
                                e.preventDefault();                       
                              
                        
                                // Perform the AJAX request
                                $.ajax({
                                    type: 'POST',
                                    url: '/healthcenter/student/', // Specify the URL
                                    data: {
                                        csrfmiddlewaretoken: '{{ csrf_token }}',
                                        description: $('#description').val(),
                                        designation: $('#designation').val(),                                      
                                        medical_relief_submit: $('#Submit').val(),

                                    },                                   
                                    success: function(data) {
                                        if (data.status === 1) {
                                            alert("Form submitted successfully");
                                            // Optionally, reload the page
                                            window.location.reload();
                                        } else {
                                            // Handle specific server error cases if needed
                                            alert("Error submitting the form: " + data.error);
                                        }
                                    }
                                });
                            });                  
                        
                        
                        </script>                    
              



    </div>
</div>
    
<div class="ui tab" data-tab="inbox">
    <div class="ui vertical segment" >
        <table  border=1 class="ui very basic collapsing celled large sortable table"
              style="padding-left: 2.5%;padding-right: 2.5%;margin: auto;" >
            <thead>
            <tr>
                
                <td style="font-weight:bold;color:black;">
                    Upload Date
                </td>

                <td style="font-weight:bold;color:black;" >
                    Approval Date
                </td>
                <td style="font-weight:bold;color:black;">
                    Description
                </td>               
                <td style="font-weight:bold;color:black;">
                    File
                </td>               
                <td style="font-weight:bold;color:black;">
                    Status
                </td>               

            </tr>
            </thead>

            <tbody>
            {% for inbox in medicalRelief %}
            <tr>

                <td style="white-space:nowrap;">                    
                    {{ inbox.upload_date}}

                </td>
                <td style="white-space:nowrap;">                
                           
                    {{inbox.approval_date}}   
    
                </td>

                <td style="white-space:nowrap;">
                    {{ inbox.desc}}       
                   
                </td>
                <td style="white-space:nowrap;">
                    {{ inbox.file}}       
                   
                </td>

                
                <td>
                    {% if inbox.status == True %}
                        Approved
                    {% else %}
                        Pending
                    {% endif %}

                </td>

               

            </tr>
            {% endfor %}

            </tbody>
        </table>

            <script>
                function rem(id) {
                    $.ajax({
                        type: 'POST',
                        url: '/healthcenter/compounder/', // Specify the URL
                        data: {
                            csrfmiddlewaretoken: '{{ csrf_token }}',
                            file_id: id,  
                            compounder_forward: 1,                            
                        },
                        success: function(data) {
                            if (data.status === 1) {
                                alert("Forwarded to Accounts Admin");
                                // Optionally, reload the page
                                window.location.reload();
                            }
                        }
                    });
                }
                
                
           
        </script>

    </div>
</div>



{% endblock %}

